<!DOCTYPE html>
<html>
<head>
  <title>Manifest Dashboard</title>
  <script src="https://unpkg.com/htmx.org"></script>
  <style>
    body { font-family: sans-serif; padding: 2rem; }
    .manifest-link { display: block; margin-bottom: 0.5rem; cursor: pointer; }
    pre { background: #f4f4f4; padding: 1rem; border-radius: 5px; }
    .diff-table { overflow-x: auto; font-size: 14px; }
    .diff-table table { width: 100%; border-collapse: collapse; }
    .diff-table th, .diff-table td {
      padding: 4px 8px;
      border: 1px solid #ccc;
      font-family: monospace;
      vertical-align: top;
    }
    .diff-table .diff_add { background-color: #e6ffe6; }
    .diff-table .diff_chg { background-color: #ffffcc; }
    .diff-table .diff_sub { background-color: #ffe6e6; }
  </style>
</head>
<body>
  <h1>üì¶ Manifest Dashboard</h1>

<form hx-get="/manifest/" hx-target="body" hx-swap="outerHTML">
  <label for="version">üìÇ Version:</label>
  <select name="v" id="version" onchange="this.form.requestSubmit()">
    {% for v in all_versions %}
      <option value="{{ v }}" {% if v == version %}selected{% endif %}>{{ v }}</option>
    {% endfor %}
  </select>
</form>


  {% for name in manifest_names %}
    <a class="manifest-link"
       hx-get="/manifest/load/{{ name }}/"
       hx-target="#viewer"
       hx-swap="innerHTML"
       aria-label="Load manifest {{ name }}"
       title="Load manifest {{ name }}">
      üîç {{ name }}
    </a>
  {% endfor %}
  <!-- Add fallback message for empty manifest_names -->
  {% if manifest_names|length == 0 %}
    <p>No manifests available to display.</p>
  {% endif %}
  <hr>
  <div id="viewer">
    <p>Click a manifest to preview.</p>
  </div>

<form hx-get="/manifest/diff/" hx-target="#diff-result" hx-swap="innerHTML">
  <label>From:</label>
  <select name="a">
    {% for v in all_versions %}
      <option value="{{ v }}">{{ v }}</option>
    {% endfor %}
  </select>

  <label>To:</label>
  <select name="b">
    {% for v in all_versions %}
      <option value="{{ v }}" {% if v == version %}selected{% endif %}>{{ v }}</option>
    {% endfor %}
  </select>

  <button type="submit">Compare</button>
</form>

<!-- Add fallback message for empty all_versions -->
{% if all_versions|length == 0 %}
  <p>No versions available to select.</p>
{% endif %}

<hr>

<div id="diff-result">
  <p><em>Select two versions and compare their bootstrap.json</em></p>
</div>

</body>
</html>
